# React 17.0.3 源码解析

> 本文档从五月中旬开始写，大概要一到两个月的时间完成，主要关注React 17源码解析

***

在开始本文档之前已阅读源码近两个月，看过很多关于React源码解析的文章以及视频，整个过程比想象的要难，React的源码比Vue3.0的源码要难的多，而且涉及很多的概念，包括Fiber，双缓存，lane模型，小顶堆（调度时使用），分片渲染，requestidlecallback等等。最近决定重读一遍源码，并把读源码过程中的所思所想记入下来，如果有不足以及不对的地方，希望各位同学批评指正。

> 本篇文章是学习React的第一篇文章，后期会陆续跟新，暂定分为10期

## React 源码难学吗？

今年年初回想自己已经工作快8年了（暴露年龄了），从事前端工作也快五年了，除了学会了ctrl+c，ctrl+v就不会太多的东西，突然一阵脊背发凉，下定决心攀一座高峰——读React源码。

好，下定决心，那就开始，先下载React源码，稍微数了下，整个packages中有36模块，一脸的懵逼，感觉无从下手，是不是很多小伙伴在这一步就被劝退了，随手截了个图小伙伴可以自己感受下。

![image-20210514135054234](/Users/maxuelong/Library/Application Support/typora-user-images/image-20210514135054234.png)

## 那么怎么学习React呢

无论React源码多难我们都要学，因为这关系到我们的money，那么React源码应该怎么读呢？学习React源码最忌讳的就是纠结每个函数的实现，这样容易让我们进入无限函数调用或递归中，最终会导致我们像盗梦空间一样，分不清自己是在现实还是在梦中。

我的学习过程是这酱子的，先整体了解各个模块的功能，弄清各个模块之间的调用关系，好比说React模块，只是提供了了一些基本的还是和对象，比如createElement，useEffect，useReducer，Children等，这个模块极其简单，很容易看懂。了解了各个模块大致功能后，我们可以根据入口函数ReactDom.render开始梳理各个函数的调用，整理出来调用关系后，我们在深入了解每个函数的实现，各个类型定义的含义，以及为什么这样的定义。

**在编程的世界中，不进则退，只要学不死，我们就往死里学**

## React的核心是什么

回归主题，React的核心是什么，我总结了下：

- 更新机制
- 双环存
- Fiber树
- React中的调度系统

这几项我认为是React中最难的部分，如果翻过这几座高山，React源码其实很简单。通过这几部分的相互调用就能完成整个React大厦的构建。下面我通过导图的方式来展示下Render过程的调用流程图：

![react Render阶段.png](https://github.com/tanxiliunian/mk/blob/master/react17/images/react%20Render%E9%98%B6%E6%AE%B5.png?raw=true)



